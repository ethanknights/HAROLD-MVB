#PURPOSE:
#
#Load Data for the Sensorimotor Task
#
#Then use 'df' in the other short scripts  for:
#- unviariate mean
#- MVB spread
#- MVB boost (ordinal category codes)
#- MVB multivariate mapping (real vs. shuffled onsets)
#- MVPA between-finger
library(ggplot2)
library(Hmisc)
library(MASS)
library(reshape2)
library(sfsmisc)
library(sjPlot)
library(BayesFactor)
library(sjmisc)
library(dplyr)
library(tidyverse)
library(broom)
library(Rcpp)
library(stringi)
library(foreign)
library(mdscore)
rm(list = ls()) # clears environment
cat("\f") # clears console
dev.off() # clears graphics device
graphics.off() #clear plots
#---- Setup ----#
# wd <- "/imaging/ek03/MVB/FreeSelection/MVB/R"
wd = dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(wd)
rawDir = "csv"
outImageDir = 'images'
dir.create(outImageDir)
#---- Load Data ----#
rawD <- read.csv(file.path(rawDir,'data.csv'), header=TRUE,sep=",")
df = rawD
#---- Transform some stuff ----#
#Age quadratic expansion
df$age0z2 <- poly(df$age0z,2) #1st linear, 2nd quad
#make variablers factors
df$ordy <- as.factor(df$ordy) #Check it worked: sapply(df, class)
#rescale out of scanner RT
df$outScanner_RTmean <- df$outScanner_RTmean * 1000
df$outScanner_RTsd <- df$outScanner_RTsd * 1000
#df$inScanner_RTmean <- df$inScanner_RTmean * 1000
#df$inScanner_RTsd <- df$inScanner_RTsd * 1000
#---- assign subs a tertile age group in df$tert ----#
#https://stackoverflow.com/questions/62574146/how-to-create-tertile-in-r
# Find tertiles
vTert = quantile(df$age, c(0:3/3)) #rememebr this is useful for plot_model
df$ageTert = with(df,
cut(age,
vTert,
include.lowest = T,
labels = c("YA", "ML", "OA")))
#---- Run Analyses (manually) ----#
# run_fMRI_univariate.R
# run_fMRI_spread.R
# run_fMRI_MVB.R
# run_BEHAV.R
# run_fMRI_MVPA.R #not this expriment!
#LH
p <- ggplot(df, aes(x = age, y = univariateMean_L)) +
geom_point(shape = 21, size = 3, colour = "indianred2", fill = "lightpink", stroke = 2)
p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ x, colour = "springgreen3", size = 3)
#p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ poly(x,2, raw = TRUE), colour = "springgreen3", size = 3)
#formatting
p <- p +
ylim(-0.1,0.2) +
scale_x_continuous(breaks = round(seq(20, max(80), by = 20),1),
limits = c(15,90)) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
panel.grid.minor = element_blank(),
axis.line =
element_line(colour = "black",size = 1.5),
axis.ticks = element_line(colour = "black",
size = 1.5),
text = element_text(size=24))
ggsave(file.path(outImageDir,'univariateMean_LH_1outliernotshown.png'),
width = 25, height = 25, units = 'cm', dpi = 300); p
p <- ggplot(df, aes(x = age, y = univariateMean_L)) +
geom_point(shape = 21, size = 3, colour = "indianred2", fill = "lightpink", stroke = 2)
p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ x, colour = "springgreen3", size = 3)
#p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ poly(x,2, raw = TRUE), colour = "springgreen3", size = 3)
#formatting
p <- p +
ylim(0.2,0.4) +
scale_y_continuous(breaks = round(seq(0.2, max(0.4), by = 0.1),1),
limits = c(0.2,0.4)) +
scale_x_continuous(breaks = round(seq(20, max(80), by = 20),1),
limits = c(15,90)) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
panel.grid.minor = element_blank(),
axis.line =
element_line(colour = "black",size = 1.5),
axis.ticks = element_line(colour = "black",
size = 1.5),
text = element_text(size=24))
ggsave(file.path(outImageDir,'univariateMean_LH_1outlier.png'),
width = 25, height = 25, units = 'cm', dpi = 300); p
# RH
p <- ggplot(df, aes(x = age, y = univariateMean_R)) +
geom_point(shape = 21, size = 3, colour = "indianred2", fill = "lightpink", stroke = 2)
#p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ x, colour = "springgreen3", size = 3)
p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ poly(x,2, raw = TRUE), colour = "springgreen3", size = 3)
#formatting
p <- p +
ylim(-0.1,0.2) +
scale_x_continuous(breaks = round(seq(20, max(80), by = 20),1),
limits = c(15,90)) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
panel.grid.minor = element_blank(),
axis.line =
element_line(colour = "black",size = 1.5),
axis.ticks = element_line(colour = "black",
size = 1.5),
text = element_text(size=24))
ggsave(file.path(outImageDir,'univariateMean_RH_1outliernotshown.png'),
width = 25, height = 25, units = 'cm', dpi = 300); p
p <- ggplot(df, aes(x = age, y = univariateMean_R)) +
geom_point(shape = 21, size = 3, colour = "indianred2", fill = "lightpink", stroke = 2)
#p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ x, colour = "springgreen3", size = 3)
p <- p + stat_smooth(method = "rlm", se = TRUE, fill = "grey60", formula = y ~ poly(x,2, raw = TRUE), colour = "springgreen3", size = 3)
#formatting
p <- p +
ylim(0.2,0.4) +
scale_y_continuous(breaks = round(seq(0.2, max(0.4), by = 0.1),1),
limits = c(0.2,0.4)) +
scale_x_continuous(breaks = round(seq(20, max(80), by = 20),1),
limits = c(15,90)) +
theme_bw() +
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
panel.grid.minor = element_blank(),
axis.line =
element_line(colour = "black",size = 1.5),
axis.ticks = element_line(colour = "black",
size = 1.5),
text = element_text(size=24))
ggsave(file.path(outImageDir,'univariateMean_RH_1outlier.png'),
width = 25, height = 25, units = 'cm', dpi = 300); p
#PURPOSE:
#
#Load Data for the Free Selection Task
#
#Then use 'df' in the other short scripts  for:
#- unviariate mean
#- MVB spread
#- MVB boost (ordinal category codes)
#- MVB multivariate mapping (real vs. shuffled onsets)
#- MVPA between-finger
library(ggplot2)
library(Hmisc)
library(MASS)
library(reshape2)
library(sfsmisc)
library(sjPlot)
library(BayesFactor)
library(sjmisc)
library(dplyr)
library(tidyverse)
library(broom)
library(Rcpp)
library(stringi)
library(foreign)
library(mdscore)
rm(list = ls()) # clears environment
cat("\f") # clears console
dev.off() # clears graphics device
graphics.off() #clear plots
#---- Setup ----#
# wd <- "/imaging/ek03/MVB/FreeSelection/MVB/R"
wd = dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(wd)
rawDir = "csv"
outImageDir = 'images'
dir.create(outImageDir)
#---- Load Data ----#
rawD <- read.csv(file.path(rawDir,'data.csv'), header=TRUE,sep=",")
df = rawD
#---- Transform some stuff ----#
#Age quadratic expansion
df$age0z2 <- poly(df$age0z,2) #1st linear, 2nd quad
#make variablers factors
df$ordy <- as.factor(df$ordy) #Check it worked: sapply(df, class)
#rescale out of scanner RT
df$outScanner_RTmean <- df$outScanner_RTmean * 1000
df$outScanner_RTsd <- df$outScanner_RTsd * 1000
df$inScanner_RTmean <- df$inScanner_RTmean * 1000
df$inScanner_RTsd <- df$inScanner_RTsd * 1000
#---- assign subs a tertile age group in df$tert ----#
#https://stackoverflow.com/questions/62574146/how-to-create-tertile-in-r
# Find tertiles
vTert = quantile(df$age, c(0:3/3)) #rememebr this is useful for plot_model
df$ageTert = with(df,
cut(age,
vTert,
include.lowest = T,
labels = c("YA", "ML", "OA")))
#---- Run Analyses (manually) ----#
# run_fMRI_univariate.R
# run_fMRI_spread.R
# run_fMRI_MVB.R
# run_BEHAV.R
# run_fMRI_MVPA.R #not this expriment!
rlm_model <- rlm(inScanner_RTsd ~ univariateMean_R_0z * age0z2,
data = df, psi = psi.huber, k = 1.345)
summary(rlm_model)
f.robftest(rlm_model, var=c("univariateMean_R_0z:age0z21","univariateMean_R_0z:age0z22")) #age effect?
# f.robftest(rlm_model, var="univariateMean_R_0z:age0z21")
# f.robftest(rlm_model, var="univariateMean_R_0z:age0z22")
#Other coefficients
f.robftest(rlm_model)
f.robftest(rlm_model, var="univariateMean_R_0z")
f.robftest(rlm_model, var=c("age0z21","age0z22")) #age effect?
f.robftest(rlm_model, var="age0z21")
f.robftest(rlm_model, var="age0z22")
f.robftest(rlm_model, var=c("univariateMean_R_0z:age0z21","univariateMean_R_0z:age0z22"))
f.robftest(rlm_model)
f.robftest(rlm_model, var="univariateMean_R_0z")
f.robftest(rlm_model, var=c("age0z21","age0z22")) #age effect?
f.robftest(rlm_model, var="age0z21")
f.robftest(rlm_model, var="age0z22")
#-------------- Get bayes factors --------------#
summary(rlm_model) #reminder!!
full <-           lmBF(inScanner_RTsd ~ univariateMean_R_0z * age0z2, data = df)
noInteraction <-  lmBF(inScanner_RTsd ~ univariateMean_R_0z + age0z2, data = df)
bf10 = full / noInteraction #less than 1 favours models of
bf10
